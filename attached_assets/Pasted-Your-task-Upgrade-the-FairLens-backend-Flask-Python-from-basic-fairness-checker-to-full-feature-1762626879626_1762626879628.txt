Your task: Upgrade the FairLens backend (Flask + Python) from basic fairness checker to full-featured AI Fairness Drift Monitoring backend.

Project path: ~/workspace/fairlens_backend

Current files:
- app.py
- compliance_logger.py
- data_simulator.py
- fairness_metrics.py
- explainability_module.py
- security_utils.py
- requirements.txt

Goal:
Implement all advanced backend features as described below, without breaking existing APIs.  
Keep all imports clean, organized, and commented.  
Add necessary new files and update app.py accordingly.

-------------------------------------------------------
üß± NEW FILES TO ADD / UPDATE
-------------------------------------------------------

1Ô∏è‚É£ trend_analyzer.py  
‚Ä¢ Create SQLite database (`fairness_trends.db`)  
‚Ä¢ Table: trends (id, timestamp, dir_value, alert_status)  
‚Ä¢ Functions:
  - init_db(): create table if not exists
  - log_trend(dir_value, alert_status): insert new record
  - get_recent_trend(window=10): return last 10 dir values and average
  - check_pre_alert(threshold=0.8): return ‚ÄúPRE-ALERT‚Äù if average DIR trending down but still >= 0.8

2Ô∏è‚É£ fairness_trend.py  
‚Ä¢ Import get_recent_trend  
‚Ä¢ Function predict_fairness_drift():
   - Compute slope between first and last DIR value
   - If slope < -0.05, return warning dict
   - Else return stable

3Ô∏è‚É£ compliance_logger.py (update existing file)
‚Ä¢ Add SHA256 hashing for each alert:
   - Compute hash for event data ‚Üí store in DB & JSONL
   - Function verify_alert(record_id) ‚Üí recompute hash and verify integrity
‚Ä¢ Print ‚Äú‚úÖ Alert hash verified‚Äù message in console
‚Ä¢ Add record_id field and hash_value to every log entry

4Ô∏è‚É£ auth_middleware.py  
‚Ä¢ Simple role-based authentication
‚Ä¢ Tokens:
    MONITOR123 ‚Üí monitor
    AUDITOR123 ‚Üí auditor
    ADMIN123 ‚Üí admin
‚Ä¢ Functions:
   - verify_token(role, token)
   - decorator require_role(role)
   - POST /api/login ‚Üí returns token for selected role

5Ô∏è‚É£ blockchain_anchor.py  
‚Ä¢ Simulate blockchain anchor system
‚Ä¢ Functions:
   - anchor_to_blockchain(record_hash): generate fake tx_id = "0x" + hash[:16]
   - log tx_id + hash in blockchain_anchors.jsonl
   - get_anchor(record_hash): return tx_id for that hash

6Ô∏è‚É£ app.py (update main Flask app)
‚Ä¢ Import all new modules
‚Ä¢ Initialize DB with trend_analyzer.init_db() at startup
‚Ä¢ Add endpoints:
  - GET  /api/health  ‚Üí returns status
  - GET  /api/fairness_trend  ‚Üí calls get_recent_trend()
  - GET  /api/pre_alert  ‚Üí calls check_pre_alert()
  - GET  /api/predict_fairness_drift ‚Üí calls predict_fairness_drift()
  - GET  /api/verify_alert/<record_id> ‚Üí calls verify_alert()
  - GET  /api/get_anchor/<hash> ‚Üí calls get_anchor()
  - POST /api/submit_predictions ‚Üí accepts predictions JSON, calculates fairness, logs results
  - POST /api/login ‚Üí returns token per role
‚Ä¢ Protect /api/audit_history with @require_role("auditor")

7Ô∏è‚É£ db_manager.py (optional helper)
‚Ä¢ Handles DB connection reuse

-------------------------------------------------------
‚öôÔ∏è REQUIREMENTS UPDATE
-------------------------------------------------------
Add to requirements.txt:
flask
flask-cors
cryptography
pandas
numpy
sqlalchemy
requests

-------------------------------------------------------
üß™ TESTING
-------------------------------------------------------
After build, ensure these commands work:

python3 fairlens_backend/app.py
curl "http://127.0.0.1:5000/api/health"
curl "http://127.0.0.1:5000/api/fairness_trend"
curl "http://127.0.0.1:5000/api/predict_fairness_drift"
curl -X POST http://127.0.0.1:5000/api/login -H "Content-Type: application/json" -d '{"role":"auditor"}'
curl "http://127.0.0.1:5000/api/audit_history" -H "Authorization: Bearer AUDITOR123"

-------------------------------------------------------
‚úÖ EXPECTED OUTPUT AFTER SUCCESSFUL BUILD
-------------------------------------------------------
Console shows:
‚Äú‚úÖ All modules loaded: Trend Analyzer, Fingerprinting, RBAC, Blockchain Anchoring.‚Äù

API endpoints respond:
- /api/health ‚Üí {‚Äústatus‚Äù: ‚ÄúFairLens backend running‚Äù}
- /api/predict_fairness_drift ‚Üí returns trend and warning
- /api/get_anchor/<hash> ‚Üí returns simulated tx_id
- /api/verify_alert/<record_id> ‚Üí returns verification true/false
- /api/audit_history ‚Üí returns encrypted audit logs (auth required)
- /api/submit_predictions ‚Üí computes fairness dynamically

-------------------------------------------------------
FINAL NOTE
-------------------------------------------------------
Do not modify existing fairness logic or encryption functions.  
Integrate new modules modularly.  
Add explanatory docstrings and print logs for every major process.
